<!DOCTYPE html>
<html lang="zh-HK">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>2026å¹´ è¶Šé‡è·‘è³½äº‹æ›†</title>
    <style>
        :root {
            --primary-color: #2c3e50;
            --bg-color: #f4f6f7;
            
            /* Type 1: Holidays (ç´…è‰²) */
            --holiday-color: #c0392b;
            --holiday-bg: #fff5f5;
            
            /* User Type: Pending (é»ƒè‰² - ç”¨æ–¼è¶Šé‡è³½) */
            --user-pending-color: #d35400; 
            --user-pending-bg: #fef9e7;    
            --user-pending-border: #f5b041;

            /* User Type: Confirmed (ç¶ è‰²) */
            --user-confirmed-color: #27ae60; 
            --user-confirmed-bg: #e9f7ef;    
            --user-confirmed-border: #82e0aa;

            --weekend-color: #95a5a6;
        }
        
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif; background-color: var(--bg-color); color: #333; margin: 0; padding: 20px; }
        h1 { text-align: center; color: var(--primary-color); margin-bottom: 10px; }
        
        /* Legend */
        .legend { display: flex; justify-content: center; gap: 15px; margin-bottom: 25px; font-size: 0.9em; flex-wrap: wrap; background: white; padding: 10px; border-radius: 8px; box-shadow: 0 2px 5px rgba(0,0,0,0.05); max-width: 800px; margin-left: auto; margin-right: auto; }
        .legend-item { display: flex; align-items: center; gap: 6px; }
        .box-sample { padding: 2px 6px; border-radius: 4px; font-size: 0.8em; font-weight: bold; border: 1px solid transparent;}
        
        /* Layout */
        .calendar-year { display: grid; grid-template-columns: 1fr; gap: 40px; max-width: 900px; margin: 0 auto; }
        .month-container { background: white; border-radius: 12px; box-shadow: 0 4px 20px rgba(0,0,0,0.06); padding: 25px; }
        .month-header { text-align: center; font-weight: bold; font-size: 1.5em; margin-bottom: 20px; color: var(--primary-color); border-bottom: 2px solid #eee; padding-bottom: 10px; }
        .days-grid { display: grid; grid-template-columns: repeat(7, 1fr); gap: 6px; text-align: center; }
        .day-label { font-size: 1em; font-weight: bold; color: #666; padding: 10px 0; background: #f9f9f9; border-radius: 4px; margin-bottom: 5px; }
        
        /* Grid Cell */
        .day-cell { height: 130px; border: 1px solid #e0e0e0; border-radius: 6px; padding: 4px; cursor: pointer; transition: all 0.2s ease; display: flex; flex-direction: column; align-items: center; position: relative; background: #fff; overflow: hidden; }
        .day-cell:hover { border-color: #3498db; transform: translateY(-2px); box-shadow: 0 4px 12px rgba(0,0,0,0.1); z-index: 2; }
        .day-number { font-weight: 700; width: 100%; text-align: left; padding-left: 6px; font-size: 1.1em; margin-bottom: 4px; line-height: 1; flex-shrink: 0; }
        
        /* Tags */
        .tag { font-size: 11px; padding: 2px 5px; border-radius: 4px; margin-bottom: 2px; width: 92%; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; text-align: center; line-height: 1.3; flex-shrink: 0; border: 1px solid transparent; }
        .type-holiday .day-number { color: var(--holiday-color); }
        .type-holiday { background-color: var(--holiday-bg); border-color: #fadbd8; }
        .tag-holiday { color: var(--holiday-color); background: rgba(231, 76, 60, 0.1); font-weight: 600; }
        .is-weekend .day-number { color: var(--weekend-color); }

        /* User Event Styles */
        .tag-user-pending { background-color: var(--user-pending-bg); color: var(--user-pending-color); border: 1px solid var(--user-pending-border); margin-bottom: 2px; }
        .tag-user-confirmed { background-color: var(--user-confirmed-bg); color: var(--user-confirmed-color); border: 1px solid var(--user-confirmed-border); margin-bottom: 2px; }

        /* Modal */
        .modal { display: none; position: fixed; z-index: 1000; left: 0; top: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,0.5); justify-content: center; align-items: center; backdrop-filter: blur(3px); }
        .modal-content { background-color: white; padding: 0; border-radius: 12px; width: 90%; max-width: 500px; max-height: 85vh; box-shadow: 0 15px 30px rgba(0,0,0,0.25); overflow-y: auto; }
        .modal-header { background: #f8f9fa; padding: 15px 20px; border-bottom: 1px solid #eee; display: flex; justify-content: space-between; align-items: center; position: sticky; top: 0; z-index: 10; }
        .modal-title { font-size: 1.2em; font-weight: bold; color: #2c3e50; }
        .modal-body { padding: 20px; }
        
        .info-row { margin-bottom: 20px; padding-bottom: 20px; border-bottom: 1px dashed #e0e0e0; }
        .info-row:last-child { border-bottom: none; }
        .info-label { display: block; margin-bottom: 5px; font-weight: 600; color: #7f8c8d; font-size: 0.9em;}
        .info-value { background: #fdfdfd; padding: 10px; border-radius: 6px; border: 1px solid #eee; color: #2c3e50; line-height: 1.5; white-space: pre-wrap; }

        .status-badge { display: inline-block; padding: 4px 10px; border-radius: 12px; font-size: 0.85em; font-weight: bold; }
        .status-pending { background: var(--user-pending-bg); color: var(--user-pending-color); border: 1px solid var(--user-pending-border); }
        .status-confirmed { background: var(--user-confirmed-bg); color: var(--user-confirmed-color); border: 1px solid var(--user-confirmed-border); }
        
        .link-btn { display: inline-block; margin-top: 10px; padding: 6px 12px; background: #3498db; color: white; text-decoration: none; border-radius: 4px; font-size: 0.9em; }
        .link-btn:hover { background: #2980b9; }
        .deadline-badge { float: right; font-size: 0.8em; color: #c0392b; background: #fadbd8; padding: 2px 8px; border-radius: 4px; }

        .btn-close { background: transparent; color: #999; font-size: 1.5em; cursor: pointer; padding: 0; border:none;}
        
        @media (max-width: 480px) { .day-cell { height: 110px; } .calendar-year { gap: 20px; } .tag { font-size: 10px; } }
    </style>
</head>
<body>

    <h1>ğŸ“… 2026å¹´ è¶Šé‡è·‘è³½äº‹æ›†</h1>
    
    <div class="legend">
        <div class="legend-item">
            <div class="box-sample" style="color:var(--holiday-color); background:var(--holiday-bg);">å…¬çœ¾å‡æœŸ</div>
        </div>
        <div class="legend-item">
            <div class="box-sample" style="color:var(--user-pending-color); background:var(--user-pending-bg); border:1px solid var(--user-pending-border);">è¶Šé‡è³½ (æœªå ±å/æœªç¢ºå®š)</div>
        </div>
        <div class="legend-item">
            <div class="box-sample" style="color:var(--user-confirmed-color); background:var(--user-confirmed-bg); border:1px solid var(--user-confirmed-border);">å·²ç¢ºèªè¡Œç¨‹</div>
        </div>
    </div>

    <div id="calendar-container" class="calendar-year"></div>

    <!-- Details Modal -->
    <div id="eventModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title" id="modalDate"></div>
                <button class="btn-close" onclick="closeModal()">Ã—</button>
            </div>
            <div class="modal-body">
                <div id="modalContent"></div>
            </div>
        </div>
    </div>

<script>
    // ==========================================
    // 1. å…¬çœ¾å‡æœŸ
    // ==========================================
    const holidays2026 = {
        "1-1": "å…ƒæ—¦", "2-17": "è¾²æ›†å¹´åˆä¸€", "2-18": "è¾²æ›†å¹´åˆäºŒ", "2-19": "è¾²æ›†å¹´åˆä¸‰",
        "4-3": "è€¶ç©Œå—é›£ç¯€", "4-4": "å—é›£ç¯€ç¿Œæ—¥", "4-6": "æ¸…æ˜ç¯€ç¿Œæ—¥", "4-7": "å¾©æ´»ç¯€é€±ä¸€",
        "5-1": "å‹å‹•ç¯€", "5-25": "ä½›èª•ç¿Œæ—¥", "6-19": "ç«¯åˆç¯€", "7-1": "ç‰¹å€ç´€å¿µæ—¥",
        "9-26": "ä¸­ç§‹ç¯€ç¿Œæ—¥", "10-1": "åœ‹æ…¶æ—¥", "10-19": "é‡é™½ç¯€ç¿Œæ—¥", 
        "12-25": "è–èª•ç¯€", "12-26": "è–èª•ç¯€ç¿Œæ—¥"
    };

    // ==========================================
    // 2. è¶Šé‡è³½äº‹è³‡æ–™åº« (Trail Only)
    // ==========================================
    const myEvents2026 = [
        // 1æœˆ
        //{ date: "1-22", title: "HK100 The Third", status: "pending", details: "è·é›¢: 33K\nåœ°é»: è¥¿è²¢", link: "https://hk100ultra.com/the-third/", deadline: "éœ€åƒé–±å®˜ç¶²" },
        //{ date: "1-23", title: "HK100 The Half", status: "pending", details: "è·é›¢: 56K\nåœ°é»: è¥¿è²¢", link: "https://hk100ultra.com/the-half/", deadline: "éœ€åƒé–±å®˜ç¶²" },
        //{ date: "1-24", title: "HK100", status: "pending", details: "è·é›¢: 103K\nåœ°é»: è¥¿è²¢", link: "https://hk100ultra.com/", deadline: "éœ€åƒé–±å®˜ç¶²" },
        { date: "1-18", title: "é¦™æ¸¯æ¸£æ‰“é¦¬æ‹‰æ¾", status: "Confirmed", details: "è·é›¢: 10k,åŠé¦¬,å…¨é¦¬\nåœ°é»: ", link: "https://www.hkmarathon.com/zh-hant", deadline: "éœ€åƒé–±å®˜ç¶²" },
		{ date: "1-24", title: "ç’°å³¶è¡Œç·´ç¿’", status: "Confirmed", details: "è·é›¢: CP3-6\nåœ°é»: æ¸¯å³¶å¾‘", link: "https://hike.greenpower.org.hk/", deadline: "éœ€åƒé–±å®˜ç¶²" },
		{ date: "1-31", title: "ç¶ è‰²åŠ›é‡ç’°å³¶è¡Œ", status: "Confirmed", details: "è·é›¢: 10/25/50K\nåœ°é»: æ¸¯å³¶å¾‘", link: "https://hike.greenpower.org.hk/", deadline: "éœ€åƒé–±å®˜ç¶²" },
        //{ date: "1-31", title: "Gurkha Trailblazer", status: "pending", details: "è·é›¢: 12/30K\nåœ°é»: æµæ°´éŸ¿", link: "https://gurkhatrailblazer.com/", deadline: "éœ€åƒé–±å®˜ç¶²" },
        //{ date: "1-31", title: "Spark Run", status: "pending", details: "è·é›¢: 25/50K\nåœ°é»: è¥¿è²¢", link: "https://www.sephk.com/sparkrun/", deadline: "éœ€åƒé–±å®˜ç¶²" },

        // 2æœˆ
        { date: "2-1", title: "Spark Run", status: "pending", details: "è·é›¢: 8.5/14.5K\nåœ°é»: è¥¿è²¢", link: "https://www.sephk.com/sparkrun/", deadline: "éœ€åƒé–±å®˜ç¶²" },
        { date: "2-1", title: "Fat Mak Trail Race", status: "pending", details: "è·é›¢: 14/35K\nåœ°é»: åŸé–€", link: "https://www.noracenogoal.com/fmtr-2026", deadline: "éœ€åƒé–±å®˜ç¶²" },
        { date: "2-7", title: "HK50 West", status: "pending", details: "è·é›¢: 11/25/55K\nåœ°é»: åŸé–€", link: "https://www.actionasiaevents.com/our-events/upcoming-events/2026-hk50-west-race-3-hk50-series/event-info-%E8%B3%BD%E4%BA%8B%E7%B0%A1%E4%BB%8B.html", deadline: "éœ€åƒé–±å®˜ç¶²" },
        { date: "2-7", title: "é«˜å³°å°æ±ºæ²ˆé›²å±±", status: "pending", details: "è·é›¢: 2.6K\nåœ°é»: è§€å¡˜", link: "https://www.thepeakrunner.com/%E6%B1%BA%E6%88%B0%E6%B2%88%E9%9B%B2%E5%B1%B1", deadline: "éœ€åƒé–±å®˜ç¶²" },
        { date: "2-8", title: "å±±é‡ä¹‹ç‹ (è¥¿è²¢)", status: "pending", details: "è·é›¢: 21.8/35.9K\nåœ°é»: åŒ—æ½­æ¶Œ", link: "https://www.seyonasia.com/koth.php", deadline: "éœ€åƒé–±å®˜ç¶²" },
        { date: "2-8", title: "è¿·ä½ å››å¾‘@æ¸¯å³¶å¾‘", status: "pending", details: "è·é›¢: 16.4K\nåœ°é»: é¦™æ¸¯ä»”", link: "https://www.fourtrailsmini.com/zh/%e8%b3%bd%e4%ba%8b/%e9%a6%99%e6%b8%af%e5%b3%b6/?lang=zh", deadline: "éœ€åƒé–±å®˜ç¶²" },
        { date: "2-8", title: "å››ç¥è¨˜ - è™èº", status: "pending", details: "è·é›¢: 8/14/20K\nåœ°é»: å¤§å¸½å±±", link: "https://rundaevents.com/tiger-leap-2025/", deadline: "éœ€åƒé–±å®˜ç¶²" },
        { date: "2-15", title: "Touge Fifty å³ 50", status: "pending", details: "è·é›¢: 18/40K\nåœ°é»: åŒ—æ½­æ¶Œ", link: "https://www.noracenogoal.com/t50-2026", deadline: "éœ€åƒé–±å®˜ç¶²" },
        { date: "2-19", title: "Namedsport å·é¾è¶Šé‡", status: "pending", details: "è·é›¢: 8/21/42K\nåœ°é»: å¤§å¸½å±±", link: "https://www.life-fever.com/chuenlung2026", deadline: "éœ€åƒé–±å®˜ç¶²" },
        { date: "2-19", title: "SCARPA é¦¬åˆä¸‰", status: "pending", details: "è·é›¢: 13/20K\nåœ°é»: å¤§æ½­", link: "https://www.wildtrekhk.com/home-%E4%B8%BB%E9%A0%81", deadline: "éœ€åƒé–±å®˜ç¶²" },
        { date: "2-27", title: "The 9 Dragons", status: "pending", details: "è·é›¢: 25/50K/50mi\nåœ°é»: å¤§åŸ”é ­", link: "https://www.the9dragons.asia/", deadline: "éœ€åƒé–±å®˜ç¶²" },
        { date: "2-28", title: "Sai Kung 50", status: "pending", details: "è·é›¢: 13/22/35/54K\nåœ°é»: åŒ—æ½­æ¶Œ", link: "https://www.actionasiaevents.com/our-events/2026-sai-kung-50-race-4-hk50-series/overview-%E7%B2%BE%E8%8F%AF%E7%89%87%E6%AE%B5.html#content", deadline: "éœ€åƒé–±å®˜ç¶²" },

        // 3æœˆ
        { date: "3-1", title: "å››ç¥è¨˜ - é’é¾é¨°", status: "pending", details: "è·é›¢: 8/14/20K\nåœ°é»: å¤§æ½­", link: "https://rundaevents.com/dragon-soar/", deadline: "éœ€åƒé–±å®˜ç¶²" },
        { date: "3-1", title: "Sai Kung Speed", status: "pending", details: "è·é›¢: 15/36K\nåœ°é»: åŒ—æ½­æ¶Œ", link: "https://www.noracenogoal.com/sks-2026", deadline: "éœ€åƒé–±å®˜ç¶²" },
        { date: "3-1", title: "è¿·ä½ å››å¾‘@é³¯å‡°å¾‘", status: "pending", details: "è·é›¢: 13.5K\nåœ°é»: æ¢…çª©", link: "https://www.fourtrailsmini.com/zh/%e8%b3%bd%e4%ba%8b/%e9%b3%af%e5%87%b0%e5%be%91/?lang=zh", deadline: "éœ€åƒé–±å®˜ç¶²" },
        { date: "3-6", title: "Victoria 162", status: "pending", details: "è·é›¢: 25-162K\nåœ°é»: æ±æ¶Œ (3æ—¥è³½)", link: "https://www.victoria162.hk/", deadline: "éœ€åƒé–±å®˜ç¶²" },
        { date: "3-14", title: "Action Asia æ·ºæ°´ç£", status: "pending", details: "è·é›¢: 9/14K\nåœ°é»: æ·ºæ°´ç£", link: "https://www.actionasiaevents.com/our-events/upcoming-events/2026-action-sprint-trail-series-repulse-bay/overview-%E7%B2%BE%E8%8F%AF%E7%89%87%E6%AE%B5.html#content", deadline: "éœ€åƒé–±å®˜ç¶²" },
        { date: "3-15", title: "æ™‚å…‰éš§é“è¶Šé‡è³½", status: "pending", details: "è·é›¢: 15/26K\nåœ°é»: å¤§æ£ ", link: "https://www.noracenogoal.com/str-2026", deadline: "éœ€åƒé–±å®˜ç¶²" },
        { date: "3-15", title: "RunAround å¸½è‰é‡", status: "pending", details: "è·é›¢: 16K\nåœ°é»: å¤§å¸½å±±", link: "https://in.njuko.com/run-around-hgn-20261760877228789?currentPage=select-competition", deadline: "éœ€åƒé–±å®˜ç¶²" },
        { date: "3-15", title: "AirFly Trail Race", status: "pending", details: "è·é›¢: 20/30K\nåœ°é»: ç‰›æ± ç£", link: "https://www.airflytrailrace.com/", deadline: "éœ€åƒé–±å®˜ç¶²" },
        { date: "3-22", title: "æ¹æ°´ä¸€æˆ°", status: "pending", details: "è·é›¢: 7/15/30K\nåœ°é»: æ¸¯å³¶å¾‘", link: "https://raceforwater.adropoflife.org/", deadline: "éœ€åƒé–±å®˜ç¶²" },
        { date: "3-22", title: "å±±é‡ä¹‹ç‹ (æ¸¯å³¶)", status: "pending", details: "è·é›¢: 18.3/31.2K\nåœ°é»: æ·ºæ°´ç£", link: "https://www.seyonasia.com/koth.php", deadline: "éœ€åƒé–±å®˜ç¶²" },
        { date: "3-29", title: "è¿·ä½ å››å¾‘@éº¥ç†æµ©å¾‘", status: "pending", details: "è·é›¢: 16K\nåœ°é»: åŸé–€", link: "https://www.fourtrailsmini.com/zh/%e8%b3%bd%e4%ba%8b/%e9%ba%a5%e7%90%86%e6%b5%a9%e5%be%91/?lang=zh", deadline: "éœ€åƒé–±å®˜ç¶²" },
        { date: "3-29", title: "Trail X", status: "pending", details: "è·é›¢: 16/35K\nåœ°é»: å¤§åŸ”é ­", link: "https://www.noracenogoal.com/trailx-2026", deadline: "éœ€åƒé–±å®˜ç¶²" },
        { date: "3-29", title: "Healthy Hike & Run", status: "pending", details: "è·é›¢: 5/13/19K\nåœ°é»: å¤§æ£ ", link: "https://www.actionasiaevents.com/our-events/2026-healthy-hike-and-run-tai-lam-hong-kong/overview-%E7%B2%BE%E8%8F%AF%E7%89%87%E6%AE%B5.html#content", deadline: "éœ€åƒé–±å®˜ç¶²" },

        // 4æœˆ
        { date: "4-11", title: "é¦™æ¸¯äº”å³° HK 5 Peaks", status: "pending", details: "è·é›¢: 21/30K\nåœ°é»: å¤§æ½­", link: "https://www.mountainrangehk.com/", deadline: "éœ€åƒé–±å®˜ç¶²" },
        { date: "4-12", title: "å±±é‡ä¹‹ç‹ (å¤§åŸ”)", status: "pending", details: "è·é›¢: 16.9/37.1K\nåœ°é»: å¤§åŸ”", link: "https://www.seyonasia.com/koth.php", deadline: "éœ€åƒé–±å®˜ç¶²" },
        { date: "4-12", title: "Action Asia è¥¿è²¢", status: "pending", details: "è·é›¢: 12/18K\nåœ°é»: åŒ—æ½­æ¶Œ", link: "https://www.actionasiaevents.com/our-events/2026-action-sprint-trail-series-sai-kung/overview-%E7%B2%BE%E8%8F%AF%E7%89%87%E6%AE%B5.html#content", deadline: "éœ€åƒé–±å®˜ç¶²" },
        { date: "4-19", title: "Round the Lion", status: "pending", details: "è·é›¢: 21K\nåœ°é»: TBC", link: "https://www.facebook.com/roundthelion", deadline: "éœ€åƒé–±å®˜ç¶²" },
        { date: "4-26", title: "å››ç¥è¨˜ - ç„æ­¦é®", status: "pending", details: "è·é›¢: 8/14/20K\nåœ°é»: å¤§æ£ ", link: "https://rundaevents.com/black-tortoise-town/", deadline: "éœ€åƒé–±å®˜ç¶²" },
        { date: "4-26", title: "è¿·ä½ å››å¾‘@è¡›å¥•ä¿¡å¾‘", status: "pending", details: "è·é›¢: 17.4K\nåœ°é»: å¤§åŸ”é ­", link: "https://www.fourtrailsmini.com/zh/%e8%b3%bd%e4%ba%8b/rmac-%e8%a1%9b%e5%a5%95%e4%bf%a1%e5%be%91/?lang=zh", deadline: "éœ€åƒé–±å®˜ç¶²" },
        { date: "4-26", title: "COUNTRY OF ORIGIN", status: "pending", details: "è·é›¢: 10/30K\nåœ°é»: æ¢…çª©", link: "https://www.racebase.asia/the-last-ever-country-of-origin-race-ever", deadline: "éœ€åƒé–±å®˜ç¶²" },
        { date: "4-26", title: "Action Asia æ„‰æ™¯ç£", status: "pending", details: "è·é›¢: 9/12K\nåœ°é»: æ„‰æ™¯ç£", link: "https://www.actionasiaevents.com/our-events/2026-action-sprint-trail-series-dbay-hong-kong/overview-%E7%B2%BE%E8%8F%AF%E7%89%87%E6%AE%B5.html#content", deadline: "éœ€åƒé–±å®˜ç¶²" },

        // 5æœˆ & 6æœˆ
        { date: "5-1", title: "Hard as...", status: "pending", details: "è·é›¢: 7/15K\nåœ°é»: æ¸…æ°´ç£", link: "https://www.racebase.asia/hard-as", deadline: "éœ€åƒé–±å®˜ç¶²" },
        { date: "6-14", title: "æ±ºæˆ°æ±æ´‹ä¹‹å·”", status: "pending", details: "è·é›¢: 15.3K\nåœ°é»: ç…å­å±±å…¬åœ’", link: "https://www.raceresults.com.hk/event/436", deadline: "éœ€åƒé–±å®˜ç¶²" }
    ];

    const modal = document.getElementById('eventModal');
    const container = document.getElementById('calendar-container');

    // Group events by date
    function groupEventsByDate() {
        const grouped = {};
        myEvents2026.forEach(event => {
            if (!grouped[event.date]) {
                grouped[event.date] = [];
            }
            grouped[event.date].push(event);
        });
        return grouped;
    }

    const eventsByDate = groupEventsByDate();

    function initCalendar() {
        container.innerHTML = '';
        const months = ["ä¸€æœˆ", "äºŒæœˆ", "ä¸‰æœˆ", "å››æœˆ", "äº”æœˆ", "å…­æœˆ", "ä¸ƒæœˆ", "å…«æœˆ", "ä¹æœˆ", "åæœˆ", "åä¸€æœˆ", "åäºŒæœˆ"];
        const weekDays = ["æ—¥", "ä¸€", "äºŒ", "ä¸‰", "å››", "äº”", "å…­"];

        for (let m = 0; m < 12; m++) {
            const monthDiv = document.createElement('div');
            monthDiv.className = 'month-container';
            
            const header = document.createElement('div');
            header.className = 'month-header';
            header.innerText = months[m];
            monthDiv.appendChild(header);

            const grid = document.createElement('div');
            grid.className = 'days-grid';

            weekDays.forEach(wd => {
                const wdLabel = document.createElement('div');
                wdLabel.className = 'day-label';
                wdLabel.innerText = wd;
                if(wd === "æ—¥" || wd === "å…­") wdLabel.style.color = "#c0392b";
                grid.appendChild(wdLabel);
            });

            const firstDay = new Date(2026, m, 1).getDay();
            const daysInMonth = new Date(2026, m + 1, 0).getDate();

            for (let i = 0; i < firstDay; i++) grid.appendChild(document.createElement('div'));

            for (let d = 1; d <= daysInMonth; d++) {
                const dateKey = `${m+1}-${d}`;
                const cell = document.createElement('div');
                cell.className = 'day-cell';
                
                const dayOfWeek = new Date(2026, m, d).getDay();
                if (dayOfWeek === 0 || dayOfWeek === 6) cell.classList.add('is-weekend');

                const holidayName = holidays2026[dateKey];
                const myEventsOnThisDay = eventsByDate[dateKey] || [];

                if (holidayName) cell.classList.add('type-holiday');
                
                // æ—¥æœŸ
                const numSpan = document.createElement('span');
                numSpan.className = 'day-number';
                numSpan.innerText = d;
                cell.appendChild(numSpan);

                // Holiday
                if (holidayName) {
                    const tag = document.createElement('div');
                    tag.className = 'tag tag-holiday';
                    tag.innerText = holidayName;
                    cell.appendChild(tag);
                }

                // Events
                myEventsOnThisDay.forEach(evt => {
                    const tag = document.createElement('div');
                    tag.innerText = evt.title;
                    tag.className = evt.status === 'pending' ? 'tag tag-user-pending' : 'tag tag-user-confirmed';
                    cell.appendChild(tag);
                });

                if(holidayName || myEventsOnThisDay.length > 0) {
                    cell.onclick = () => showDetails(m+1, d, holidayName, myEventsOnThisDay);
                }
                
                grid.appendChild(cell);
            }
            monthDiv.appendChild(grid);
            container.appendChild(monthDiv);
        }
    }

    function showDetails(month, day, hol, evts) {
        document.getElementById('modalDate').innerText = `${month}æœˆ${day}æ—¥ è©³ç´°è³‡è¨Š`;
        let contentHtml = '';

        if(hol) {
            contentHtml += `
            <div class="info-row">
                <span class="info-label">ğŸ”´ å…¬çœ¾å‡æœŸ</span>
                <div class="info-value" style="color:var(--holiday-color); font-weight:bold;">${hol}</div>
            </div>`;
        }

        if(evts && evts.length > 0) {
            evts.forEach((evt, index) => {
                const statusClass = evt.status === 'pending' ? 'status-pending' : 'status-confirmed';
                const statusText = evt.status === 'pending' ? 'âš ï¸ æœªå ±å/æœªç¢ºå®š' : 'âœ… å·²ç¢ºèªè¡Œç¨‹';
                
                let linkHtml = '';
                if(evt.link) {
                    linkHtml = `<a href="${evt.link}" target="_blank" class="link-btn">ğŸ”— å‰å¾€è³½äº‹å®˜ç¶²</a>`;
                }

                let deadlineHtml = '';
                if(evt.deadline) {
                    deadlineHtml = `<span class="deadline-badge">æˆªæ­¢: ${evt.deadline}</span>`;
                }
                
                contentHtml += `
                <div class="info-row">
                    <div style="display:flex; justify-content:space-between; align-items:center;">
                        <span class="info-label">è³½äº‹ ${evts.length > 1 ? `#${index + 1}` : ''}</span>
                        ${deadlineHtml}
                    </div>
                    <span class="status-badge ${statusClass}">${statusText}</span>
                    <div class="info-value" style="font-weight:bold; margin-top:8px;">${evt.title}</div>
                    <div class="info-value" style="margin-top:8px;">${evt.details || 'ç„¡è©³ç´°å…§å®¹'}</div>
                    ${linkHtml}
                </div>`;
            });
        }

        document.getElementById('modalContent').innerHTML = contentHtml;
        modal.style.display = 'flex';
    }

    function closeModal() {
        modal.style.display = 'none';
    }

    window.onclick = function(e) { if(e.target == modal) closeModal(); }
    initCalendar();
</script>
</body>
</html>
